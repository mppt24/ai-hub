services:
  redis:
    image: redis:7-alpine
    restart: unless-stopped

  agent-hub:
    build: ./agent-hub
    restart: unless-stopped
    environment:
      - REDIS_URL=redis://redis:6379/0
      - OLLAMA_URL=${OLLAMA_URL:-http://172.17.0.1:11434}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - ENABLE_OPENAI=${ENABLE_OPENAI:-false}
      - ALLOWED_ORIGINS=${ALLOWED_ORIGINS:-*}
    depends_on:
      - redis
    extra_hosts:
      - "host.docker.internal:host-gateway"
    ports:
      - "${HUB_PORT:-8181}:8080"
